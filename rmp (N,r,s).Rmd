---
title: "simplematch(N)"
author: "Steph"
date: "3/19/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Finding rmp of a particular profile (generated by R) in a population of size N
```{r}
source("Functions/rmp(N,r,s).R")
```

```{r}
nsim <- 10^4

N <- 10^8    ## pop size
r <- 6        ## number of loci 
s <- 10       ## number of alleles on each loci

n.core <- 8

tmp <- vector("list", nsim)

time <- system.time({
  results <- unlist(pbmclapply (tmp, FUN = function(y) {
                                rmp(N,r,s) },
                                  mc.cores = n.core))
                    })

sum(results)/length(results)
closeAllConnections()

```


